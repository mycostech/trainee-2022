----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------

------------- ALL THE LISTED COMMANDS SHALL BE EXECUTED IN ORDER ONE BY ONE ------------------

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
--- 1) create a new database called myDB. ----------------------------------------------------
----------------------------------------------------------------------------------------------

create database myDB;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------


----------------------------------------------------------------------------------------------
--- 2)  create a new table called Customers --------------------------------------------------
----------------------------------------------------------------------------------------------

use myDB;
create table Customers(
	CustomerID int primary key not null,
	FirstName varchar(40),
	LastName varchar(40),
	Email varchar(255),
	PhoneNumber varchar(20),
	ClassCode int,
);

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
---- 3) Add a new column of type INT called Age-----------------------------------------------
----------------------------------------------------------------------------------------------

alter table Customers add Age int;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 4) Insert 4 new records as Picture 1 -----------------------------------------------------
----------------------------------------------------------------------------------------------

insert into Customers (CustomerID, FirstName, LastName, Age, Email, PhoneNumber, ClassCode) values (1,'FirstA','LastA',20,'FirstA@gmail.com','0911234567',1);
insert into Customers (CustomerID, FirstName, LastName, Age, Email, PhoneNumber, ClassCode) values (2,'FirstB','LastB',21,'FirstB@hotmail.com','0929876543',2);
insert into Customers (CustomerID, FirstName, LastName, Age, Email, PhoneNumber, ClassCode) values (3,'FirstC','LastC',22,'FirstC@hotmail.com','0937894561',3);
insert into Customers (CustomerID, FirstName, LastName, Age, Email, PhoneNumber, ClassCode) values (4,'FirstD','LastD',22,'FirstD@gmail.com','0941253654',2);

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------

----------------------------------------------------------------------------------------------
--- 5) create new table called CustomerClass -------------------------------------------------
----------------------------------------------------------------------------------------------

create table CustomerClass(
	ClassCode int primary key not null,
	ClassDescription varchar(255)
);

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------


----------------------------------------------------------------------------------------------
--- 6) Insert 3 new records to CustomerClass as shown in Picture 2
----------------------------------------------------------------------------------------------

insert into CustomerClass values (1,'Classic');
insert into CustomerClass values (2, 'Gold');
insert into CustomerClass values (3, 'Platinum');

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------


----------------------------------------------------------------------------------------------
--- 7) foregin key link customer and customerclass
----------------------------------------------------------------------------------------------

-- to prevent the key constraint conflict

alter table Customers add foreign key (ClassCode) references CustomerClass(ClassCode);

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 8) Select all records from Customers and CustomerClass as shown in Pic 1 and 2
----------------------------------------------------------------------------------------------

select * from Customers;
select * from CustomerClass;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------


----------------------------------------------------------------------------------------------
--- 9) Select records from Customers table where FirstName value is 'FirstD'
----------------------------------------------------------------------------------------------

select * from Customers where FirstName = 'FirstD';

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 10) Select all records of FirstName, LastName, Age, ClassCode, ClassDescription of Customer and CustomerClass table.
----------------------------------------------------------------------------------------------

select * from Customers join CustomerClass on Customers.ClassCode = CustomerClass.ClassCode;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------


----------------------------------------------------------------------------------------------
--- 11) Select all the different values from Age column in the Customer table. 
----------------------------------------------------------------------------------------------

select distinct Age from Customers;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 12) Select all records from the Customers table, sort the result alphabetically by the column PhoneNumber 
----------------------------------------------------------------------------------------------

select * from Customers order by PhoneNumber asc;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 13) Select all records where the value of an Email column contains the word "hotmail" 
----------------------------------------------------------------------------------------------

select * from Customers where Email like '%hotmail%'

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------




----------------------------------------------------------------------------------------------
--- 14) Select the record with the highest value of the ClassCode column
----------------------------------------------------------------------------------------------

select top 1 * from Customers order by ClassCode desc 

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------




----------------------------------------------------------------------------------------------
--- 15) Update the Email column to new email of CustomerID value is 1
----------------------------------------------------------------------------------------------

update Customers set Email = 'new email' where CustomerID = 1;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------


----------------------------------------------------------------------------------------------
--- 16) Select the last record of the Customer table.
----------------------------------------------------------------------------------------------

select top 1 * from Customers order by CustomerID desc;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 17) Select the class description of the customer phone number included ‘7894561’.
----------------------------------------------------------------------------------------------

select ClassDescription from Customers join CustomerClass on Customers.ClassCode = CustomerClass.ClassCode where PhoneNumber like '%7894561%'

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------




----------------------------------------------------------------------------------------------
--- 18) Select all customers that their class = ‘Gold’
----------------------------------------------------------------------------------------------

select * from Customers join CustomerClass on CustomerClass.ClassCode = Customers.ClassCode where ClassDescription = 'Gold'

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 19) Delete the record from the Customers table where the FirstName value is ‘FirstD’.
----------------------------------------------------------------------------------------------

delete from Customers where FirstName = 'FirstD'

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------



----------------------------------------------------------------------------------------------
--- 20) Create view called CustomerDetail (Picture 3).
----------------------------------------------------------------------------------------------

create view CustomerDetail as
select FirstName, LastName, Age, Email, PhoneNumber, ClassDescription
from Customers join CustomerClass on Customers.ClassCode = CustomerClass.ClassCode;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------




----------------------------------------------------------------------------------------------
--- 21) Select all records of CustomerDetail view.
----------------------------------------------------------------------------------------------

select * from CustomerDetail;

----------------------------------------------------------------------------------------------
----------------------------------------------------------------------------------------------

